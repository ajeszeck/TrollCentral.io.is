<h1>Question Show Page</h1>
<div> <!-- Question DIV -->
  <div> <!-- Question Text -->
    <h2>QUESTION: <%=  @question.question_text %></h2>
  </div>
  <div class="question-vote">
    <%# FIXME: Fix hard-coded user id when we add sessions! %>
    <%= erb :'partials/_vote',
    locals: {user_id: 1, type: "question", voteable_id: @question.id} %>
    <p>
      Vote total: <%= @question.votes.pluck(:value).reduce(:+).to_i %>
    </p>
  </div>
  <div> <!-- Comment Section -->
    <ul>
      <% @question.comments.each do |comment| %>
        <li><%= comment.comment_text %></li>
      <% end %>
    </ul>
    <% if session[:user_id] %>
      <form action="/questions/<%= @question.id %>/comments" method="post">
        <label>Add Comment:</label>
        <input type="text" name="comment_text">
        <input type="submit" value="Submit">
      </form>
    <% end %>
  </div>

<div id="answer_list">
  <% if @question.answers %>
  <div>
    <% @question.answers.each do |answer| %>
    <h2>
      ANSWER: <%= answer.answer_text %>
    </h2>
    <ul>
      <% answer.comments.each do |comment| %>
      <li><%= comment.comment_text %></li>
      <% end %>
    </ul>
    <div>
      <% if session[:user_id] %>
        <form action="/questions/<%= @question.id %>/answers/<%= answer.id %>/comments" method="post">
          <label>Add Comment:</label>
          <input type="text" name="comment_text">
          <input type="submit" value="Submit">
        </form>
      <% end %>
    <div class="answer_vote">
      <%# FIXME: Fix hard-coded user id when we add sessions! %>
      <%= erb :'partials/_vote',
      locals: {user_id: 1, type: "answer", voteable_id: answer.id} %>
      <p>
        Vote total: <%= answer.votes.pluck(:value).reduce(:+).to_i %>
      </p>
    </div>
    <% end %>
  </div>
  <% end %>
</div>

<% if session[:user_id] %>
  <div id="new_question"> <!-- NEW ANSWER -->
    <form action="/questions/<%= @question.id %>/answers" method="post">
      <label for="question_text">Add Your Answer: </label>
      <input name="answer[answer_text]"></input>
      <input type="hidden" name="answer[question_id]" value="<%= @question.id %>"/>
      <input type="hidden" name="answer[user_id]" value="0"/>
      <input type="submit" value="Submit" />
    </form>
  </div>
<% end %>
